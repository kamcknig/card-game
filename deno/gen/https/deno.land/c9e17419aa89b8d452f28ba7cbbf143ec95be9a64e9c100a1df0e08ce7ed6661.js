export function parseXMessage(raw) {
  const fieldValues = {};
  let f = undefined;
  let m = 0;
  for (const data of raw[1]){
    if (m % 2 === 0) {
      f = data;
    } else if (f) {
      fieldValues[f] = data;
    }
    m++;
  }
  return {
    xid: parseXId(raw[0]),
    fieldValues: fieldValues
  };
}
export function convertMap(raw) {
  const fieldValues = new Map();
  let f = undefined;
  let m = 0;
  for (const data of raw){
    if (m % 2 === 0 && typeof data === "string") {
      f = data;
    } else if (m % 2 === 1 && f) {
      fieldValues.set(f, data);
    }
    m++;
  }
  return fieldValues;
}
export function parseXReadReply(raw) {
  const out = [];
  for (const [key, idData] of raw ?? []){
    const messages = [];
    for (const rawMsg of idData){
      messages.push(parseXMessage(rawMsg));
    }
    out.push({
      key,
      messages
    });
  }
  return out;
}
export function parseXId(raw) {
  const [ms, sn] = raw.split("-");
  return {
    unixMs: parseInt(ms),
    seqNo: parseInt(sn)
  };
}
export function parseXPendingConsumers(raws) {
  const out = [];
  for (const raw of raws){
    if (isCondArray(raw) && isString(raw[0]) && isString(raw[1])) {
      out.push({
        name: raw[0],
        pending: parseInt(raw[1])
      });
    }
  }
  return out;
}
export function parseXPendingCounts(raw) {
  const infos = [];
  for (const r of raw){
    if (isCondArray(r) && isString(r[0]) && isString(r[1]) && isNumber(r[2]) && isNumber(r[3])) {
      infos.push({
        xid: parseXId(r[0]),
        owner: r[1],
        lastDeliveredMs: r[2],
        timesDelivered: r[3]
      });
    }
  }
  return infos;
}
export function parseXGroupDetail(rawGroups) {
  const out = [];
  for (const rawGroup of rawGroups){
    if (isCondArray(rawGroup)) {
      const data = convertMap(rawGroup);
      // array of arrays
      const consDeets = data.get("consumers");
      out.push({
        name: rawstr(data.get("name") ?? null),
        lastDeliveredId: parseXId(rawstr(data.get("last-delivered-id") ?? null)),
        pelCount: rawnum(data.get("pel-count") ?? null),
        pending: parseXPendingCounts(data.get("pending")),
        consumers: parseXConsumerDetail(consDeets)
      });
    }
  }
  return out;
}
export function parseXConsumerDetail(nestedRaws) {
  const out = [];
  for (const raws of nestedRaws){
    const data = convertMap(raws);
    const pending = data.get("pending").map((p)=>{
      return {
        xid: parseXId(rawstr(p[0])),
        lastDeliveredMs: rawnum(p[1]),
        timesDelivered: rawnum(p[2])
      };
    });
    const r = {
      name: rawstr(data.get("name") ?? null),
      seenTime: rawnum(data.get("seen-time") ?? null),
      pelCount: rawnum(data.get("pel-count") ?? null),
      pending
    };
    out.push(r);
  }
  return out;
}
export function xidstr(xid) {
  if (typeof xid === "string") return xid;
  if (typeof xid === "number") return `${xid}-0`;
  if (xid instanceof Array && xid.length > 1) return `${xid[0]}-${xid[1]}`;
  if (isXId(xid)) return `${xid.unixMs}-${xid.seqNo}`;
  throw "fail";
}
export function rawnum(raw) {
  return raw ? +raw.toString() : 0;
}
export function rawstr(raw) {
  return raw ? raw.toString() : "";
}
// deno-lint-ignore no-explicit-any
export function isString(x) {
  return typeof x === "string";
}
// deno-lint-ignore no-explicit-any
export function isNumber(x) {
  return typeof x === "number";
}
export function isCondArray(x) {
  const l = x.length;
  if (l > 0 || l < 1) return true;
  else return false;
}
function isXId(xid) {
  return xid.unixMs !== undefined;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImh0dHBzOi8vZGVuby5sYW5kL3gvc29ja2V0X2lvQDAuMi4xL3ZlbmRvci9kZW5vLmxhbmQveC9yZWRpc0B2MC4yNy4xL3N0cmVhbS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgdHlwZSB7IENvbmRpdGlvbmFsQXJyYXksIFJhdywgUmVkaXNWYWx1ZSB9IGZyb20gXCIuL3Byb3RvY29sL21vZC50c1wiO1xuXG5leHBvcnQgaW50ZXJmYWNlIFhJZCB7XG4gIHVuaXhNczogbnVtYmVyO1xuICBzZXFObzogbnVtYmVyO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFhNZXNzYWdlIHtcbiAgeGlkOiBYSWQ7XG4gIGZpZWxkVmFsdWVzOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+O1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFhLZXlJZCB7XG4gIGtleTogc3RyaW5nO1xuICB4aWQ6IFhJZElucHV0O1xufVxuXG5leHBvcnQgdHlwZSBYS2V5SWRMaWtlID0gW3N0cmluZywgWElkSW5wdXRdO1xuXG5leHBvcnQgaW50ZXJmYWNlIFhLZXlJZEdyb3VwIHtcbiAga2V5OiBzdHJpbmc7XG4gIHhpZDogWElkR3JvdXBSZWFkO1xufVxuXG5leHBvcnQgdHlwZSBYS2V5SWRHcm91cExpa2UgPSBbc3RyaW5nLCBYSWRHcm91cFJlYWRdO1xuXG5leHBvcnQgdHlwZSBYUmVhZFN0cmVhbSA9IHsga2V5OiBzdHJpbmc7IG1lc3NhZ2VzOiBYTWVzc2FnZVtdIH07XG5leHBvcnQgdHlwZSBYUmVhZFJlcGx5ID0gWFJlYWRTdHJlYW1bXTtcblxuLy8gYmFzaWMgZGF0YSByZXR1cm5lZCBieSByZWRpc1xuZXhwb3J0IHR5cGUgWFJlYWRJZERhdGEgPSBbc3RyaW5nLCBzdHJpbmdbXV07XG5leHBvcnQgdHlwZSBYUmVhZFN0cmVhbVJhdyA9IFtzdHJpbmcsIFhSZWFkSWREYXRhW11dO1xuZXhwb3J0IHR5cGUgWFJlYWRSZXBseVJhdyA9IFhSZWFkU3RyZWFtUmF3W107XG5cbi8qKiBGbGV4aWJsZSBpbnB1dCB0eXBlIGZvciBjb21tYW5kcyB3aGljaCByZXF1aXJlIG1lc3NhZ2VcbiAqIElEIHRvIGJlIHBhc3NlZCAocmVwcmVzZW50ZWQgaW4gbG93ZXItbGV2ZWwgUmVkaXMgQVBJIGFzXG4gKiBcIjEwMDAtMFwiIGV0YykuXG4gKlxuICogV2UgYWxzbyBpbmNsdWRlIGFuIGFycmF5IGZvcm1hdCBmb3IgZWFzZSBvZiB1c2UsIHdoZXJlXG4gKiB0aGUgZmlyc3QgZWxlbWVudCBpcyB0aGUgZXBvY2hNaWxsaXMsIHNlY29uZCBpcyBzZXFOby5cbiAqXG4gKiBXZSBhbHNvIGFsbG93IHBhc3NpbmcgYSBzaW5nbGUgbnVtYmVyLFxuICogd2hpY2ggd2lsbCByZXByZXNlbnQgdGhlIHRoZSBlcG9jaCBNaWxsaXMgd2l0aFxuICogc2VxTm8gb2YgemVyby4gIChFc3BlY2lhbGx5IHVzZWZ1bCBpcyB0byBwYXNzIDAuKVxuICovXG5leHBvcnQgdHlwZSBYSWRJbnB1dCA9IFhJZCB8IFtudW1iZXIsIG51bWJlcl0gfCBudW1iZXI7XG4vKipcbiAqIElEIGlucHV0IHR5cGUgZm9yIFhBREQsIHdoaWNoIGlzIGFsbG93ZWQgdG8gaW5jbHVkZSB0aGVcbiAqIFwiKlwiIG9wZXJhdG9yLiAqL1xuZXhwb3J0IHR5cGUgWElkQWRkID0gWElkSW5wdXQgfCBcIipcIjtcbi8qKlxuICogSUQgaW5wdXQgdHlwZSBmb3IgWEdST1VQUkVBRCwgd2hpY2ggaXMgYWxsb3dlZCB0byBpbmNsdWRlXG4gKiB0aGUgXCI+XCIgb3BlcmF0b3IuICBXZSBpbmNsdWRlIGFuIGFycmF5IGZvcm1hdCBmb3IgZWFzZSBvZlxuICogdXNlLCB3aGVyZSB0aGUgZmlyc3QgZWxlbWVudCBpcyB0aGUgZXBvY2hNaWxsaXMsIHNlY29uZFxuICogaXMgc2VxTm8uICovXG5leHBvcnQgdHlwZSBYSWRHcm91cFJlYWQgPSBYSWRJbnB1dCB8IFwiPlwiO1xuXG4vKiogQWxsb3dzIHNwZWNpYWwgbWF4aW11bSBJRCBmb3IgWFJBTkdFIGFuZCBYUkVWUkFOR0UgKi9cbmV4cG9ydCB0eXBlIFhJZFBvcyA9IFhJZElucHV0IHwgXCIrXCI7XG4vKiogQWxsb3dzIHNwZWNpYWwgbWluaW11bSBJRCBmb3IgWFJBTkdFIGFuZCBYUkVWUkFOR0UgKi9cbmV4cG9ydCB0eXBlIFhJZE5lZyA9IFhJZElucHV0IHwgXCItXCI7XG4vKiogQWxsb3cgc3BlY2lhbCAkIElEIGZvciBYR1JPVVAgQ1JFQVRFICovXG5leHBvcnQgdHlwZSBYSWRDcmVhdGVHcm91cCA9IFhJZElucHV0IHwgXCIkXCI7XG5cbmV4cG9ydCB0eXBlIFhBZGRGaWVsZFZhbHVlcyA9XG4gIHwgUmVjb3JkPHN0cmluZyB8IG51bWJlciwgUmVkaXNWYWx1ZT5cbiAgfCBNYXA8c3RyaW5nIHwgbnVtYmVyLCBSZWRpc1ZhbHVlPjtcblxuZXhwb3J0IGludGVyZmFjZSBYUmVhZE9wdHMge1xuICBjb3VudD86IG51bWJlcjtcbiAgYmxvY2s/OiBudW1iZXI7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgWFJlYWRHcm91cE9wdHMge1xuICBncm91cDogc3RyaW5nO1xuICBjb25zdW1lcjogc3RyaW5nO1xuICBjb3VudD86IG51bWJlcjtcbiAgYmxvY2s/OiBudW1iZXI7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgWE1heGxlbiB7XG4gIGFwcHJveD86IGJvb2xlYW47XG4gIGVsZW1lbnRzOiBudW1iZXI7XG59XG5cbmV4cG9ydCB0eXBlIFhDbGFpbVJlcGx5ID0gWENsYWltTWVzc2FnZXMgfCBYQ2xhaW1KdXN0WElkO1xuZXhwb3J0IGludGVyZmFjZSBYQ2xhaW1NZXNzYWdlcyB7XG4gIGtpbmQ6IFwibWVzc2FnZXNcIjtcbiAgbWVzc2FnZXM6IFhNZXNzYWdlW107XG59XG5leHBvcnQgaW50ZXJmYWNlIFhDbGFpbUp1c3RYSWQge1xuICBraW5kOiBcImp1c3R4aWRcIjtcbiAgeGlkczogWElkW107XG59XG5cbi8qKlxuICogQHBhcmFtIGNvdW50IExpbWl0IG9uIHRoZSBudW1iZXIgb2YgbWVzc2FnZXMgdG8gcmV0dXJuIHBlciBjYWxsLlxuICogQHBhcmFtIHN0YXJ0SWQgSUQgZm9yIHRoZSBmaXJzdCBwZW5kaW5nIHJlY29yZC5cbiAqIEBwYXJhbSBlbmRJZCAgSUQgZm9yIHRoZSBmaW5hbCBwZW5kaW5nIHJlY29yZC5cbiAqIEBwYXJhbSBjb25zdW1lcnMgIEV2ZXJ5IGNvbnN1bWVyIGluIHRoZSBjb25zdW1lciBncm91cFxuICogd2l0aCBhdCBsZWFzdCBvbmUgcGVuZGluZyBtZXNzYWdlLCBhbmQgdGhlIG51bWJlciBvZlxuICogcGVuZGluZyBtZXNzYWdlcyBpdCBoYXMuXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgWFBlbmRpbmdSZXBseSB7XG4gIGNvdW50OiBudW1iZXI7XG4gIHN0YXJ0SWQ6IFhJZDtcbiAgZW5kSWQ6IFhJZDtcbiAgY29uc3VtZXJzOiBYUGVuZGluZ0NvbnN1bWVyW107XG59XG5leHBvcnQgaW50ZXJmYWNlIFhQZW5kaW5nQ29uc3VtZXIge1xuICBuYW1lOiBzdHJpbmc7XG4gIHBlbmRpbmc6IG51bWJlcjtcbn1cblxuLyoqXG4gKiBSZXByZXNlbnRzIGEgcGVuZGluZyBtZXNzYWdlIHBhcnNlZCBmcm9tIHhwZW5kaW5nLlxuICpcbiAqIEBwYXJhbSBpZCBUaGUgSUQgb2YgdGhlIG1lc3NhZ2VcbiAqIEBwYXJhbSBjb25zdW1lciBUaGUgbmFtZSBvZiB0aGUgY29uc3VtZXIgdGhhdCBmZXRjaGVkIHRoZSBtZXNzYWdlXG4gKiAgYW5kIGhhcyBzdGlsbCB0byBhY2tub3dsZWRnZSBpdC4gV2UgY2FsbCBpdCB0aGVcbiAqICBjdXJyZW50IG93bmVyIG9mIHRoZSBtZXNzYWdlLlxuICogQHBhcmFtIGxhc3REZWxpdmVyZWRNcyBUaGUgbnVtYmVyIG9mIG1pbGxpc2Vjb25kcyB0aGF0IGVsYXBzZWQgc2luY2UgdGhlXG4gKiAgbGFzdCB0aW1lIHRoaXMgbWVzc2FnZSB3YXMgZGVsaXZlcmVkIHRvIHRoaXMgY29uc3VtZXIuXG4gKiBAcGFyYW0gdGltZXNEZWxpdmVyZWQgVGhlIG51bWJlciBvZiB0aW1lcyB0aGlzIG1lc3NhZ2Ugd2FzIGRlbGl2ZXJlZC5cbiAqL1xuZXhwb3J0IGludGVyZmFjZSBYUGVuZGluZ0NvdW50IHtcbiAgeGlkOiBYSWQ7XG4gIG93bmVyOiBzdHJpbmc7XG4gIGxhc3REZWxpdmVyZWRNczogbnVtYmVyO1xuICB0aW1lc0RlbGl2ZXJlZDogbnVtYmVyO1xufVxuLyoqIFVzZWQgaW4gdGhlIFhQRU5ESU5HIGNvbW1hbmQsIGFsbCB0aHJlZSBvZiB0aGVzZVxuICogYXJncyBtdXN0IGJlIHNwZWNpZmllZCBpZiBfYW55XyBhcmUgc3BlY2lmaWVkLlxuICovXG5leHBvcnQgaW50ZXJmYWNlIFN0YXJ0RW5kQ291bnQge1xuICBzdGFydDogbnVtYmVyIHwgXCItXCI7XG4gIGVuZDogbnVtYmVyIHwgXCIrXCI7XG4gIGNvdW50OiBudW1iZXI7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgWEluZm9TdHJlYW1SZXBseSB7XG4gIGxlbmd0aDogbnVtYmVyO1xuICByYWRpeFRyZWVLZXlzOiBudW1iZXI7XG4gIHJhZGl4VHJlZU5vZGVzOiBudW1iZXI7XG4gIGdyb3VwczogbnVtYmVyO1xuICBsYXN0R2VuZXJhdGVkSWQ6IFhJZDtcbiAgZmlyc3RFbnRyeTogWE1lc3NhZ2U7XG4gIGxhc3RFbnRyeTogWE1lc3NhZ2U7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgWEluZm9TdHJlYW1GdWxsUmVwbHkge1xuICBsZW5ndGg6IG51bWJlcjtcbiAgcmFkaXhUcmVlS2V5czogbnVtYmVyO1xuICByYWRpeFRyZWVOb2RlczogbnVtYmVyO1xuICBsYXN0R2VuZXJhdGVkSWQ6IFhJZDtcbiAgZW50cmllczogWE1lc3NhZ2VbXTtcbiAgZ3JvdXBzOiBYR3JvdXBEZXRhaWxbXTtcbn1cblxuLyoqXG4gKiBDaGlsZCBvZiB0aGUgcmV0dXJuIHR5cGUgZm9yIHhpbmZvX3N0cmVhbV9mdWxsXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgWEdyb3VwRGV0YWlsIHtcbiAgbmFtZTogc3RyaW5nO1xuICBsYXN0RGVsaXZlcmVkSWQ6IFhJZDtcbiAgcGVsQ291bnQ6IG51bWJlcjtcbiAgcGVuZGluZzogWFBlbmRpbmdDb3VudFtdO1xuICBjb25zdW1lcnM6IFhDb25zdW1lckRldGFpbFtdO1xufVxuLyoqIENoaWxkIG9mIFhJTkZPIFNUUkVBTVMgRlVMTCByZXNwb25zZSAqL1xuZXhwb3J0IGludGVyZmFjZSBYQ29uc3VtZXJEZXRhaWwge1xuICBuYW1lOiBzdHJpbmc7XG4gIHNlZW5UaW1lOiBudW1iZXI7XG4gIHBlbENvdW50OiBudW1iZXI7XG4gIHBlbmRpbmc6IHsgeGlkOiBYSWQ7IGxhc3REZWxpdmVyZWRNczogbnVtYmVyOyB0aW1lc0RlbGl2ZXJlZDogbnVtYmVyIH1bXTtcbn1cblxuZXhwb3J0IHR5cGUgWEluZm9Db25zdW1lcnNSZXBseSA9IFhJbmZvQ29uc3VtZXJbXTtcbi8qKlxuICogQSBjb25zdW1lciBwYXJzZWQgZnJvbSB4aW5mbyBjb21tYW5kLlxuICpcbiAqIEBwYXJhbSBuYW1lIE5hbWUgb2YgdGhlIGNvbnN1bWVyIGdyb3VwLlxuICogQHBhcmFtIHBlbmRpbmcgTnVtYmVyIG9mIHBlbmRpbmcgbWVzc2FnZXMgZm9yIHRoaXMgc3BlY2lmaWMgY29uc3VtZXIuXG4gKiBAcGFyYW0gaWRsZSBUaGlzIGNvbnN1bWVyJ3MgaWRsZSB0aW1lIGluIG1pbGxpc2Vjb25kcy5cbiAqL1xuZXhwb3J0IGludGVyZmFjZSBYSW5mb0NvbnN1bWVyIHtcbiAgbmFtZTogc3RyaW5nO1xuICBwZW5kaW5nOiBudW1iZXI7XG4gIGlkbGU6IG51bWJlcjtcbn1cblxuLyoqIFJlc3BvbnNlIHRvIFhJTkZPIEdST1VQUyA8a2V5PiAqL1xuZXhwb3J0IHR5cGUgWEluZm9Hcm91cHNSZXBseSA9IFhJbmZvR3JvdXBbXTtcbmV4cG9ydCBpbnRlcmZhY2UgWEluZm9Hcm91cCB7XG4gIG5hbWU6IHN0cmluZztcbiAgY29uc3VtZXJzOiBudW1iZXI7XG4gIHBlbmRpbmc6IG51bWJlcjtcbiAgbGFzdERlbGl2ZXJlZElkOiBYSWQ7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgWENsYWltT3B0cyB7XG4gIGdyb3VwOiBzdHJpbmc7XG4gIGNvbnN1bWVyOiBzdHJpbmc7XG4gIG1pbklkbGVUaW1lOiBudW1iZXI7XG4gIGlkbGU/OiBudW1iZXI7XG4gIHRpbWU/OiBudW1iZXI7XG4gIHJldHJ5Q291bnQ/OiBudW1iZXI7XG4gIGZvcmNlPzogYm9vbGVhbjtcbiAganVzdFhJZD86IGJvb2xlYW47XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBwYXJzZVhNZXNzYWdlKHJhdzogWFJlYWRJZERhdGEpOiBYTWVzc2FnZSB7XG4gIGNvbnN0IGZpZWxkVmFsdWVzOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+ID0ge307XG4gIGxldCBmOiBzdHJpbmcgfCB1bmRlZmluZWQgPSB1bmRlZmluZWQ7XG5cbiAgbGV0IG0gPSAwO1xuICBmb3IgKGNvbnN0IGRhdGEgb2YgcmF3WzFdKSB7XG4gICAgaWYgKG0gJSAyID09PSAwKSB7XG4gICAgICBmID0gZGF0YTtcbiAgICB9IGVsc2UgaWYgKGYpIHtcbiAgICAgIGZpZWxkVmFsdWVzW2ZdID0gZGF0YTtcbiAgICB9XG4gICAgbSsrO1xuICB9XG5cbiAgcmV0dXJuIHsgeGlkOiBwYXJzZVhJZChyYXdbMF0pLCBmaWVsZFZhbHVlczogZmllbGRWYWx1ZXMgfTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNvbnZlcnRNYXAocmF3OiBDb25kaXRpb25hbEFycmF5KTogTWFwPHN0cmluZywgUmF3PiB7XG4gIGNvbnN0IGZpZWxkVmFsdWVzOiBNYXA8c3RyaW5nLCBSYXc+ID0gbmV3IE1hcCgpO1xuICBsZXQgZjogc3RyaW5nIHwgdW5kZWZpbmVkID0gdW5kZWZpbmVkO1xuXG4gIGxldCBtID0gMDtcbiAgZm9yIChjb25zdCBkYXRhIG9mIHJhdykge1xuICAgIGlmIChtICUgMiA9PT0gMCAmJiB0eXBlb2YgZGF0YSA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgZiA9IGRhdGE7XG4gICAgfSBlbHNlIGlmIChtICUgMiA9PT0gMSAmJiBmKSB7XG4gICAgICBmaWVsZFZhbHVlcy5zZXQoZiwgZGF0YSk7XG4gICAgfVxuICAgIG0rKztcbiAgfVxuXG4gIHJldHVybiBmaWVsZFZhbHVlcztcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHBhcnNlWFJlYWRSZXBseShyYXc6IFhSZWFkUmVwbHlSYXcpOiBYUmVhZFJlcGx5IHtcbiAgY29uc3Qgb3V0OiBYUmVhZFN0cmVhbVtdID0gW107XG4gIGZvciAoY29uc3QgW2tleSwgaWREYXRhXSBvZiByYXcgPz8gW10pIHtcbiAgICBjb25zdCBtZXNzYWdlcyA9IFtdO1xuICAgIGZvciAoY29uc3QgcmF3TXNnIG9mIGlkRGF0YSkge1xuICAgICAgbWVzc2FnZXMucHVzaChwYXJzZVhNZXNzYWdlKHJhd01zZykpO1xuICAgIH1cbiAgICBvdXQucHVzaCh7IGtleSwgbWVzc2FnZXMgfSk7XG4gIH1cblxuICByZXR1cm4gb3V0O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gcGFyc2VYSWQocmF3OiBzdHJpbmcpOiBYSWQge1xuICBjb25zdCBbbXMsIHNuXSA9IHJhdy5zcGxpdChcIi1cIik7XG4gIHJldHVybiB7IHVuaXhNczogcGFyc2VJbnQobXMpLCBzZXFObzogcGFyc2VJbnQoc24pIH07XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBwYXJzZVhQZW5kaW5nQ29uc3VtZXJzKFxuICByYXdzOiBDb25kaXRpb25hbEFycmF5LFxuKTogWFBlbmRpbmdDb25zdW1lcltdIHtcbiAgY29uc3Qgb3V0OiBYUGVuZGluZ0NvbnN1bWVyW10gPSBbXTtcblxuICBmb3IgKGNvbnN0IHJhdyBvZiByYXdzKSB7XG4gICAgaWYgKGlzQ29uZEFycmF5KHJhdykgJiYgaXNTdHJpbmcocmF3WzBdKSAmJiBpc1N0cmluZyhyYXdbMV0pKSB7XG4gICAgICBvdXQucHVzaCh7IG5hbWU6IHJhd1swXSwgcGVuZGluZzogcGFyc2VJbnQocmF3WzFdKSB9KTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gb3V0O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gcGFyc2VYUGVuZGluZ0NvdW50cyhyYXc6IENvbmRpdGlvbmFsQXJyYXkpOiBYUGVuZGluZ0NvdW50W10ge1xuICBjb25zdCBpbmZvczogWFBlbmRpbmdDb3VudFtdID0gW107XG4gIGZvciAoY29uc3QgciBvZiByYXcpIHtcbiAgICBpZiAoXG4gICAgICBpc0NvbmRBcnJheShyKSAmJlxuICAgICAgaXNTdHJpbmcoclswXSkgJiZcbiAgICAgIGlzU3RyaW5nKHJbMV0pICYmXG4gICAgICBpc051bWJlcihyWzJdKSAmJlxuICAgICAgaXNOdW1iZXIoclszXSlcbiAgICApIHtcbiAgICAgIGluZm9zLnB1c2goe1xuICAgICAgICB4aWQ6IHBhcnNlWElkKHJbMF0pLFxuICAgICAgICBvd25lcjogclsxXSxcbiAgICAgICAgbGFzdERlbGl2ZXJlZE1zOiByWzJdLFxuICAgICAgICB0aW1lc0RlbGl2ZXJlZDogclszXSxcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiBpbmZvcztcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHBhcnNlWEdyb3VwRGV0YWlsKHJhd0dyb3VwczogQ29uZGl0aW9uYWxBcnJheSk6IFhHcm91cERldGFpbFtdIHtcbiAgY29uc3Qgb3V0ID0gW107XG5cbiAgZm9yIChjb25zdCByYXdHcm91cCBvZiByYXdHcm91cHMpIHtcbiAgICBpZiAoaXNDb25kQXJyYXkocmF3R3JvdXApKSB7XG4gICAgICBjb25zdCBkYXRhID0gY29udmVydE1hcChyYXdHcm91cCk7XG5cbiAgICAgIC8vIGFycmF5IG9mIGFycmF5c1xuICAgICAgY29uc3QgY29uc0RlZXRzID0gZGF0YS5nZXQoXCJjb25zdW1lcnNcIikgYXMgQ29uZGl0aW9uYWxBcnJheVtdO1xuXG4gICAgICBvdXQucHVzaCh7XG4gICAgICAgIG5hbWU6IHJhd3N0cihkYXRhLmdldChcIm5hbWVcIikgPz8gbnVsbCksXG4gICAgICAgIGxhc3REZWxpdmVyZWRJZDogcGFyc2VYSWQoXG4gICAgICAgICAgcmF3c3RyKGRhdGEuZ2V0KFwibGFzdC1kZWxpdmVyZWQtaWRcIikgPz8gbnVsbCksXG4gICAgICAgICksXG4gICAgICAgIHBlbENvdW50OiByYXdudW0oZGF0YS5nZXQoXCJwZWwtY291bnRcIikgPz8gbnVsbCksXG4gICAgICAgIHBlbmRpbmc6IHBhcnNlWFBlbmRpbmdDb3VudHMoZGF0YS5nZXQoXCJwZW5kaW5nXCIpIGFzIENvbmRpdGlvbmFsQXJyYXkpLFxuICAgICAgICBjb25zdW1lcnM6IHBhcnNlWENvbnN1bWVyRGV0YWlsKGNvbnNEZWV0cyksXG4gICAgICB9KTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gb3V0O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gcGFyc2VYQ29uc3VtZXJEZXRhaWwobmVzdGVkUmF3czogUmF3W11bXSk6IFhDb25zdW1lckRldGFpbFtdIHtcbiAgY29uc3Qgb3V0OiBYQ29uc3VtZXJEZXRhaWxbXSA9IFtdO1xuXG4gIGZvciAoY29uc3QgcmF3cyBvZiBuZXN0ZWRSYXdzKSB7XG4gICAgY29uc3QgZGF0YSA9IGNvbnZlcnRNYXAocmF3cyk7XG5cbiAgICBjb25zdCBwZW5kaW5nID0gKGRhdGEuZ2V0KFwicGVuZGluZ1wiKSBhcyBbc3RyaW5nLCBudW1iZXIsIG51bWJlcl1bXSkubWFwKFxuICAgICAgKHApID0+IHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICB4aWQ6IHBhcnNlWElkKHJhd3N0cihwWzBdKSksXG4gICAgICAgICAgbGFzdERlbGl2ZXJlZE1zOiByYXdudW0ocFsxXSksXG4gICAgICAgICAgdGltZXNEZWxpdmVyZWQ6IHJhd251bShwWzJdKSxcbiAgICAgICAgfTtcbiAgICAgIH0sXG4gICAgKTtcblxuICAgIGNvbnN0IHIgPSB7XG4gICAgICBuYW1lOiByYXdzdHIoZGF0YS5nZXQoXCJuYW1lXCIpID8/IG51bGwpLFxuICAgICAgc2VlblRpbWU6IHJhd251bShkYXRhLmdldChcInNlZW4tdGltZVwiKSA/PyBudWxsKSxcbiAgICAgIHBlbENvdW50OiByYXdudW0oZGF0YS5nZXQoXCJwZWwtY291bnRcIikgPz8gbnVsbCksXG4gICAgICBwZW5kaW5nLFxuICAgIH07XG5cbiAgICBvdXQucHVzaChyKTtcbiAgfVxuXG4gIHJldHVybiBvdXQ7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiB4aWRzdHIoXG4gIHhpZDogWElkQWRkIHwgWElkTmVnIHwgWElkUG9zIHwgWElkQ3JlYXRlR3JvdXAgfCBYSWRHcm91cFJlYWQsXG4pIHtcbiAgaWYgKHR5cGVvZiB4aWQgPT09IFwic3RyaW5nXCIpIHJldHVybiB4aWQ7XG4gIGlmICh0eXBlb2YgeGlkID09PSBcIm51bWJlclwiKSByZXR1cm4gYCR7eGlkfS0wYDtcbiAgaWYgKHhpZCBpbnN0YW5jZW9mIEFycmF5ICYmIHhpZC5sZW5ndGggPiAxKSByZXR1cm4gYCR7eGlkWzBdfS0ke3hpZFsxXX1gO1xuICBpZiAoaXNYSWQoeGlkKSkgcmV0dXJuIGAke3hpZC51bml4TXN9LSR7eGlkLnNlcU5vfWA7XG4gIHRocm93IFwiZmFpbFwiO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gcmF3bnVtKHJhdzogUmF3KTogbnVtYmVyIHtcbiAgcmV0dXJuIHJhdyA/ICtyYXcudG9TdHJpbmcoKSA6IDA7XG59XG5leHBvcnQgZnVuY3Rpb24gcmF3c3RyKHJhdzogUmF3KTogc3RyaW5nIHtcbiAgcmV0dXJuIHJhdyA/IHJhdy50b1N0cmluZygpIDogXCJcIjtcbn1cbi8vIGRlbm8tbGludC1pZ25vcmUgbm8tZXhwbGljaXQtYW55XG5leHBvcnQgZnVuY3Rpb24gaXNTdHJpbmcoeDogYW55KTogeCBpcyBzdHJpbmcge1xuICByZXR1cm4gdHlwZW9mIHggPT09IFwic3RyaW5nXCI7XG59XG5cbi8vIGRlbm8tbGludC1pZ25vcmUgbm8tZXhwbGljaXQtYW55XG5leHBvcnQgZnVuY3Rpb24gaXNOdW1iZXIoeDogYW55KTogeCBpcyBudW1iZXIge1xuICByZXR1cm4gdHlwZW9mIHggPT09IFwibnVtYmVyXCI7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc0NvbmRBcnJheSh4OiBSYXcpOiB4IGlzIENvbmRpdGlvbmFsQXJyYXkge1xuICBjb25zdCBsID0gKHggYXMgQ29uZGl0aW9uYWxBcnJheSkubGVuZ3RoO1xuICBpZiAobCA+IDAgfHwgbCA8IDEpIHJldHVybiB0cnVlO1xuICBlbHNlIHJldHVybiBmYWxzZTtcbn1cblxuZnVuY3Rpb24gaXNYSWQoeGlkOiBYSWRBZGQpOiB4aWQgaXMgWElkIHtcbiAgcmV0dXJuICh4aWQgYXMgWElkKS51bml4TXMgIT09IHVuZGVmaW5lZDtcbn1cbiJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFtTkEsT0FBTyxTQUFTLGNBQWMsR0FBZ0I7RUFDNUMsTUFBTSxjQUFzQyxDQUFDO0VBQzdDLElBQUksSUFBd0I7RUFFNUIsSUFBSSxJQUFJO0VBQ1IsS0FBSyxNQUFNLFFBQVEsR0FBRyxDQUFDLEVBQUUsQ0FBRTtJQUN6QixJQUFJLElBQUksTUFBTSxHQUFHO01BQ2YsSUFBSTtJQUNOLE9BQU8sSUFBSSxHQUFHO01BQ1osV0FBVyxDQUFDLEVBQUUsR0FBRztJQUNuQjtJQUNBO0VBQ0Y7RUFFQSxPQUFPO0lBQUUsS0FBSyxTQUFTLEdBQUcsQ0FBQyxFQUFFO0lBQUcsYUFBYTtFQUFZO0FBQzNEO0FBRUEsT0FBTyxTQUFTLFdBQVcsR0FBcUI7RUFDOUMsTUFBTSxjQUFnQyxJQUFJO0VBQzFDLElBQUksSUFBd0I7RUFFNUIsSUFBSSxJQUFJO0VBQ1IsS0FBSyxNQUFNLFFBQVEsSUFBSztJQUN0QixJQUFJLElBQUksTUFBTSxLQUFLLE9BQU8sU0FBUyxVQUFVO01BQzNDLElBQUk7SUFDTixPQUFPLElBQUksSUFBSSxNQUFNLEtBQUssR0FBRztNQUMzQixZQUFZLEdBQUcsQ0FBQyxHQUFHO0lBQ3JCO0lBQ0E7RUFDRjtFQUVBLE9BQU87QUFDVDtBQUVBLE9BQU8sU0FBUyxnQkFBZ0IsR0FBa0I7RUFDaEQsTUFBTSxNQUFxQixFQUFFO0VBQzdCLEtBQUssTUFBTSxDQUFDLEtBQUssT0FBTyxJQUFJ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
// denoCacheMetadata=8737791170831191869,7746724488798379287