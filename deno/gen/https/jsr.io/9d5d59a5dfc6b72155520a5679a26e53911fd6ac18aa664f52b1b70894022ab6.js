import { intersectionBy as intersectionByToolkit } from '../../array/intersectionBy.ts';
import { last } from '../../array/last.ts';
import { uniq } from '../../array/uniq.ts';
import { identity } from '../../function/identity.ts';
import { property } from '../object/property.ts';
import { isArrayLikeObject } from '../predicate/isArrayLikeObject.ts';
/**
 * Returns the intersection of multiple arrays after applying the iteratee function to their elements.
 *
 * This function takes multiple arrays and an optional iteratee function (or property key)
 * to compare the elements after transforming them. It returns a new array containing the elements from
 * the first array that are present in all subsequent arrays after applying the iteratee to each element.
 * If no iteratee is provided, the identity function is used.
 *
 * If the first array is `null` or `undefined`, an empty array is returned.
 *
 * @template T
 * @param {ArrayLike<T> | null | undefined} array - The first array to compare.
 * @param {...(ArrayLike<T> | ((value: T) => unknown) | string)} values - The arrays to compare, or the iteratee function.
 * @returns {T[]} A new array containing the elements from the first array that are present
 *  in all subsequent arrays after applying the iteratee.
 *
 * @example
 * const array1 = [{ x: 1 }, { x: 2 }, { x: 3 }];
 * const array2 = [{ x: 2 }, { x: 3 }];
 * const result = intersectionBy(array1, array2, 'x');
 * // result will be [{ x: 2 }, { x: 3 }] since these elements have the same `x` property.
 *
 * @example
 * const array1 = [1.1, 2.2, 3.3];
 * const array2 = [2.3, 3.3];
 * const result = intersectionBy(array1, array2, Math.floor);
 * // result will be [2.3, 3.3] since it shares the same integer part when `Math.floor` is applied.
 */ export function intersectionBy(array, ...values) {
  if (!isArrayLikeObject(array)) {
    return [];
  }
  const lastValue = last(values);
  if (lastValue === undefined) {
    return Array.from(array);
  }
  let result = uniq(Array.from(array));
  const count = isArrayLikeObject(lastValue) ? values.length : values.length - 1;
  for(let i = 0; i < count; ++i){
    const value = values[i];
    if (!isArrayLikeObject(value)) {
      return [];
    }
    if (isArrayLikeObject(lastValue)) {
      result = intersectionByToolkit(result, Array.from(value), identity);
    } else if (typeof lastValue === 'function') {
      result = intersectionByToolkit(result, Array.from(value), (value)=>lastValue(value));
    } else if (typeof lastValue === 'string') {
      result = intersectionByToolkit(result, Array.from(value), property(lastValue));
    }
  }
  return result;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImh0dHBzOi8vanNyLmlvL0Blcy10b29sa2l0L2VzLXRvb2xraXQvMS4zMy4wL3NyYy9jb21wYXQvYXJyYXkvaW50ZXJzZWN0aW9uQnkudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgaW50ZXJzZWN0aW9uQnkgYXMgaW50ZXJzZWN0aW9uQnlUb29sa2l0IH0gZnJvbSAnLi4vLi4vYXJyYXkvaW50ZXJzZWN0aW9uQnkudHMnO1xuaW1wb3J0IHsgbGFzdCB9IGZyb20gJy4uLy4uL2FycmF5L2xhc3QudHMnO1xuaW1wb3J0IHsgdW5pcSB9IGZyb20gJy4uLy4uL2FycmF5L3VuaXEudHMnO1xuaW1wb3J0IHsgaWRlbnRpdHkgfSBmcm9tICcuLi8uLi9mdW5jdGlvbi9pZGVudGl0eS50cyc7XG5pbXBvcnQgeyBwcm9wZXJ0eSB9IGZyb20gJy4uL29iamVjdC9wcm9wZXJ0eS50cyc7XG5pbXBvcnQgeyBpc0FycmF5TGlrZU9iamVjdCB9IGZyb20gJy4uL3ByZWRpY2F0ZS9pc0FycmF5TGlrZU9iamVjdC50cyc7XG5cbi8qKlxuICogUmV0dXJucyB0aGUgaW50ZXJzZWN0aW9uIG9mIG11bHRpcGxlIGFycmF5cyBhZnRlciBhcHBseWluZyB0aGUgaXRlcmF0ZWUgZnVuY3Rpb24gdG8gdGhlaXIgZWxlbWVudHMuXG4gKlxuICogVGhpcyBmdW5jdGlvbiB0YWtlcyBtdWx0aXBsZSBhcnJheXMgYW5kIGFuIGl0ZXJhdGVlIGZ1bmN0aW9uIChvciBwcm9wZXJ0eSBrZXkpIHRvXG4gKiBjb21wYXJlIHRoZSBlbGVtZW50cyBhZnRlciB0cmFuc2Zvcm1pbmcgdGhlbS4gSXQgcmV0dXJucyBhIG5ldyBhcnJheSBjb250YWluaW5nIHRoZSBlbGVtZW50cyBmcm9tXG4gKiB0aGUgZmlyc3QgYXJyYXkgdGhhdCBhcmUgcHJlc2VudCBpbiBhbGwgc3Vic2VxdWVudCBhcnJheXMgYWZ0ZXIgYXBwbHlpbmcgdGhlIGl0ZXJhdGVlIHRvIGVhY2ggZWxlbWVudC5cbiAqXG4gKiBAdGVtcGxhdGUgVDEsIFQyXG4gKiBAcGFyYW0ge0FycmF5TGlrZTxUMT4gfCBudWxsIHwgdW5kZWZpbmVkfSBhcnJheSAtIFRoZSBmaXJzdCBhcnJheSB0byBjb21wYXJlLlxuICogQHBhcmFtIHtBcnJheUxpa2U8VDI+fSB2YWx1ZXMgLSBUaGUgc2Vjb25kIGFycmF5IHRvIGNvbXBhcmUuXG4gKiBAcGFyYW0geyh2YWx1ZTogVDEgfCBUMikgPT4gdW5rbm93biB8IHN0cmluZ30gaXRlcmF0ZWUgLSBUaGUgaXRlcmF0ZWUgaW52b2tlZCBvbiBlYWNoIGVsZW1lbnRcbiAqICBmb3IgY29tcGFyaXNvbi4gSXQgY2FuIGFsc28gYmUgYSBwcm9wZXJ0eSBrZXkgdG8gY29tcGFyZSBiYXNlZCBvbiB0aGF0IHByb3BlcnR5LlxuICogQHJldHVybnMge1QxW119IEEgbmV3IGFycmF5IGNvbnRhaW5pbmcgdGhlIGVsZW1lbnRzIGZyb20gdGhlIGZpcnN0IGFycmF5IHRoYXQgYXJlIHByZXNlbnRcbiAqICBpbiBhbGwgc3Vic2VxdWVudCBhcnJheXMgYWZ0ZXIgYXBwbHlpbmcgdGhlIGl0ZXJhdGVlLlxuICpcbiAqIEBleGFtcGxlXG4gKiBjb25zdCBhcnJheTEgPSBbeyB4OiAxIH0sIHsgeDogMiB9LCB7IHg6IDMgfV07XG4gKiBjb25zdCBhcnJheTIgPSBbeyB4OiAyIH0sIHsgeDogMyB9LCB7IHg6IDQgfV07XG4gKiBjb25zdCByZXN1bHQgPSBpbnRlcnNlY3Rpb25CeShhcnJheTEsIGFycmF5MiwgJ3gnKTtcbiAqIC8vIHJlc3VsdCB3aWxsIGJlIFt7IHg6IDIgfSwgeyB4OiAzIH1dIHNpbmNlIHRoZXNlIGVsZW1lbnRzIGhhdmUgdGhlIHNhbWUgYHhgIHByb3BlcnR5LlxuICpcbiAqIGNvbnN0IGFycmF5MSA9IFt7IHg6IDEgfSwgeyB4OiAyIH0sIHsgeDogMyB9XTtcbiAqIGNvbnN0IGFycmF5MiA9IFt7IHg6IDIgfSwgeyB4OiAzIH0sIHsgeDogNCB9XTtcbiAqIGNvbnN0IHJlc3VsdCA9IGludGVyc2VjdGlvbkJ5KGFycmF5MSwgYXJyYXkyLCB2YWx1ZSA9PiB2YWx1ZS54KTtcbiAqIC8vIHJlc3VsdCB3aWxsIGJlIFt7IHg6IDIgfSwgeyB4OiAzIH1dIHNpbmNlIHRoZXNlIGVsZW1lbnRzIGhhdmUgdGhlIHNhbWUgYHhgIHByb3BlcnR5LlxuICovXG5leHBvcnQgZnVuY3Rpb24gaW50ZXJzZWN0aW9uQnk8VDEsIFQyPihcbiAgYXJyYXk6IEFycmF5TGlrZTxUMT4gfCBudWxsIHwgdW5kZWZpbmVkLFxuICB2YWx1ZXM6IEFycmF5TGlrZTxUMj4sXG4gIGl0ZXJhdGVlOiAoKHZhbHVlOiBUMSB8IFQyKSA9PiB1bmtub3duKSB8IHN0cmluZ1xuKTogVDFbXTtcblxuLyoqXG4gKiBSZXR1cm5zIHRoZSBpbnRlcnNlY3Rpb24gb2YgbXVsdGlwbGUgYXJyYXlzIGFmdGVyIGFwcGx5aW5nIHRoZSBpdGVyYXRlZSBmdW5jdGlvbiB0byB0aGVpciBlbGVtZW50cy5cbiAqXG4gKiBUaGlzIGZ1bmN0aW9uIHRha2VzIG11bHRpcGxlIGFycmF5cyBhbmQgYW4gaXRlcmF0ZWUgZnVuY3Rpb24gKG9yIHByb3BlcnR5IGtleSkgdG9cbiAqIGNvbXBhcmUgdGhlIGVsZW1lbnRzIGFmdGVyIHRyYW5zZm9ybWluZyB0aGVtLiBJdCByZXR1cm5zIGEgbmV3IGFycmF5IGNvbnRhaW5pbmcgdGhlIGVsZW1lbnRzIGZyb21cbiAqIHRoZSBmaXJzdCBhcnJheSB0aGF0IGFyZSBwcmVzZW50IGluIGFsbCBzdWJzZXF1ZW50IGFycmF5cyBhZnRlciBhcHBseWluZyB0aGUgaXRlcmF0ZWUgdG8gZWFjaCBlbGVtZW50LlxuICpcbiAqIEB0ZW1wbGF0ZSBUMSwgVDIsIFQzXG4gKiBAcGFyYW0ge0FycmF5TGlrZTxUMT4gfCBudWxsIHwgdW5kZWZpbmVkfSBhcnJheSAtIFRoZSBmaXJzdCBhcnJheSB0byBjb21wYXJlLlxuICogQHBhcmFtIHtBcnJheUxpa2U8VDI+fSB2YWx1ZXMxIC0gVGhlIHNlY29uZCBhcnJheSB0byBjb21wYXJlLlxuICogQHBhcmFtIHtBcnJheUxpa2U8VDM+fSB2YWx1ZXMyIC0gVGhlIHRoaXJkIGFycmF5IHRvIGNvbXBhcmUuXG4gKiBAcGFyYW0geyh2YWx1ZTogVDEgfCBUMiB8IFQzKSA9PiB1bmtub3duIHwgc3RyaW5nfSBpdGVyYXRlZSAtIFRoZSBpdGVyYXRlZSBpbnZva2VkIG9uIGVhY2ggZWxlbWVudFxuICogIGZvciBjb21wYXJpc29uLiBJdCBjYW4gYWxzbyBiZSBhIHByb3BlcnR5IGtleSB0byBjb21wYXJlIGJhc2VkIG9uIHRoYXQgcHJvcGVydHkuXG4gKiBAcmV0dXJucyB7VDFbXX0gQSBuZXcgYXJyYXkgY29udGFpbmluZyB0aGUgZWxlbWVudHMgZnJvbSB0aGUgZmlyc3QgYXJyYXkgdGhhdCBhcmUgcHJlc2VudFxuICogIGluIGFsbCBzdWJzZXF1ZW50IGFycmF5cyBhZnRlciBhcHBseWluZyB0aGUgaXRlcmF0ZWUuXG4gKlxuICogQGV4YW1wbGVcbiAqIGNvbnN0IGFycmF5MSA9IFt7IHg6IDEgfSwgeyB4OiAyIH0sIHsgeDogMyB9XTtcbiAqIGNvbnN0IGFycmF5MiA9IFt7IHg6IDIgfSwgeyB4OiAzIH1dO1xuICogY29uc3QgYXJyYXkzID0gW3sgeDogMyB9XTtcbiAqIGNvbnN0IHJlc3VsdCA9IGludGVyc2VjdGlvbkJ5KGFycmF5MSwgYXJyYXkyLCBhcnJheTMsICd4Jyk7XG4gKiAvLyByZXN1bHQgd2lsbCBiZSBbeyB4OiAzIH1dIHNpbmNlIHRoaXMgZWxlbWVudCBoYXMgdGhlIHNhbWUgYHhgIHByb3BlcnR5IGluIGFsbCBhcnJheXMuXG4gKlxuICogY29uc3QgYXJyYXkxID0gW3sgeDogMSB9LCB7IHg6IDIgfSwgeyB4OiAzIH1dO1xuICogY29uc3QgYXJyYXkyID0gW3sgeDogMiB9LCB7IHg6IDMgfV07XG4gKiBjb25zdCBhcnJheTMgPSBbeyB4OiAzIH1dO1xuICogY29uc3QgcmVzdWx0ID0gaW50ZXJzZWN0aW9uQnkoYXJyYXkxLCBhcnJheTIsIGFycmF5MywgdmFsdWUgPT4gdmFsdWUueCk7XG4gKiAvLyByZXN1bHQgd2lsbCBiZSBbeyB4OiAzIH1dIHNpbmNlIHRoaXMgZWxlbWVudCBoYXMgdGhlIHNhbWUgYHhgIHByb3BlcnR5IGluIGFsbCBhcnJheXMuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpbnRlcnNlY3Rpb25CeTxUMSwgVDIsIFQzPihcbiAgYXJyYXk6IEFycmF5TGlrZTxUMT4gfCBudWxsIHwgdW5kZWZpbmVkLFxuICB2YWx1ZXMxOiBBcnJheUxpa2U8VDI+LFxuICB2YWx1ZXMyOiBBcnJheUxpa2U8VDM+LFxuICBpdGVyYXRlZTogKCh2YWx1ZTogVDEgfCBUMiB8IFQzKSA9PiB1bmtub3duKSB8IHN0cmluZ1xuKTogVDFbXTtcblxuLyoqXG4gKiBSZXR1cm5zIHRoZSBpbnRlcnNlY3Rpb24gb2YgbXVsdGlwbGUgYXJyYXlzIGFmdGVyIGFwcGx5aW5nIHRoZSBpdGVyYXRlZSBmdW5jdGlvbiB0byB0aGVpciBlbGVtZW50cy5cbiAqXG4gKiBUaGlzIGZ1bmN0aW9uIHRha2VzIG11bHRpcGxlIGFycmF5cyBhbmQgYW4gaXRlcmF0ZWUgZnVuY3Rpb24gKG9yIHByb3BlcnR5IGtleSkgdG9cbiAqIGNvbXBhcmUgdGhlIGVsZW1lbnRzIGFmdGVyIHRyYW5zZm9ybWluZyB0aGVtLiBJdCByZXR1cm5zIGEgbmV3IGFycmF5IGNvbnRhaW5pbmcgdGhlIGVsZW1lbnRzIGZyb21cbiAqIHRoZSBmaXJzdCBhcnJheSB0aGF0IGFyZSBwcmVzZW50IGluIGFsbCBzdWJzZXF1ZW50IGFycmF5cyBhZnRlciBhcHBseWluZyB0aGUgaXRlcmF0ZWUgdG8gZWFjaCBlbGVtZW50LlxuICpcbiAqIEB0ZW1wbGF0ZSBUMSwgVDIsIFQzLCBUNFxuICogQHBhcmFtIHtBcnJheUxpa2U8VDE+IHwgbnVsbCB8IHVuZGVmaW5lZH0gYXJyYXkgLSBUaGUgZmlyc3QgYXJyYXkgdG8gY29tcGFyZS5cbiAqIEBwYXJhbSB7QXJyYXlMaWtlPFQyPn0gdmFsdWVzMSAtIFRoZSBzZWNvbmQgYXJyYXkgdG8gY29tcGFyZS5cbiAqIEBwYXJhbSB7QXJyYXlMaWtlPFQzPn0gdmFsdWVzMiAtIFRoZSB0aGlyZCBhcnJheSB0byBjb21wYXJlLlxuICogQHBhcmFtIHsuLi4oQXJyYXlMaWtlPFQ0PiB8ICgodmFsdWU6IFQxIHwgVDIgfCBUMyB8IFQ0KSA9PiB1bmtub3duKSB8IHN0cmluZyl9IHZhbHVlcyAtIEFkZGl0aW9uYWwgYXJyYXlzIHRvIGNvbXBhcmUsIG9yIHRoZSBpdGVyYXRlZSBmdW5jdGlvbi5cbiAqIEByZXR1cm5zIHtUMVtdfSBBIG5ldyBhcnJheSBjb250YWluaW5nIHRoZSBlbGVtZW50cyBmcm9tIHRoZSBmaXJzdCBhcnJheSB0aGF0IGFyZSBwcmVzZW50XG4gKiAgaW4gYWxsIHN1YnNlcXVlbnQgYXJyYXlzIGFmdGVyIGFwcGx5aW5nIHRoZSBpdGVyYXRlZS5cbiAqXG4gKiBAZXhhbXBsZVxuICogY29uc3QgYXJyYXkxID0gW3sgeDogMSB9LCB7IHg6IDIgfSwgeyB4OiAzIH1dO1xuICogY29uc3QgYXJyYXkyID0gW3sgeDogMiB9LCB7IHg6IDMgfV07XG4gKiBjb25zdCBhcnJheTMgPSBbeyB4OiAzIH1dO1xuICogY29uc3QgYXJyYXk0ID0gW3sgeDogMyB9LCB7IHg6IDQgfV07XG4gKiBjb25zdCByZXN1bHQgPSBpbnRlcnNlY3Rpb25CeShhcnJheTEsIGFycmF5MiwgYXJyYXkzLCBhcnJheTQsICd4Jyk7XG4gKiAvLyByZXN1bHQgd2lsbCBiZSBbeyB4OiAzIH1dIHNpbmNlIHRoaXMgZWxlbWVudCBoYXMgdGhlIHNhbWUgYHhgIHByb3BlcnR5IGluIGFsbCBhcnJheXMuXG4gKlxuICogY29uc3QgYXJyYXkxID0gW3sgeDogMSB9LCB7IHg6IDIgfSwgeyB4OiAzIH1dO1xuICogY29uc3QgYXJyYXkyID0gW3sgeDogMiB9LCB7IHg6IDMgfV07XG4gKiBjb25zdCBhcnJheTMgPSBbeyB4OiAzIH1dO1xuICogY29uc3QgYXJyYXk0ID0gW3sgeDogMyB9LCB7IHg6IDQgfV07XG4gKiBjb25zdCByZXN1bHQgPSBpbnRlcnNlY3Rpb25CeShhcnJheTEsIGFycmF5MiwgYXJyYXkzLCBhcnJheTQsIHZhbHVlID0+IHZhbHVlLngpO1xuICogLy8gcmVzdWx0IHdpbGwgYmUgW3sgeDogMyB9XSBzaW5jZSB0aGlzIGVsZW1lbnQgaGFzIHRoZSBzYW1lIGB4YCBwcm9wZXJ0eSBpbiBhbGwgYXJyYXlzLlxuICovXG5leHBvcnQgZnVuY3Rpb24gaW50ZXJzZWN0aW9uQnk8VDEsIFQyLCBUMywgVDQ+KFxuICBhcnJheTogQXJyYXlMaWtlPFQxPiB8IG51bGwgfCB1bmRlZmluZWQsXG4gIHZhbHVlczE6IEFycmF5TGlrZTxUMj4sXG4gIHZhbHVlczI6IEFycmF5TGlrZTxUMz4sXG4gIC4uLnZhbHVlczogQXJyYXk8QXJyYXlMaWtlPFQ0PiB8ICgodmFsdWU6IFQxIHwgVDIgfCBUMyB8IFQ0KSA9PiB1bmtub3duKSB8IHN0cmluZz5cbik6IFQxW107XG5cbi8qKlxuICogUmV0dXJucyB0aGUgaW50ZXJzZWN0aW9uIG9mIG11bHRpcGxlIGFycmF5cyBhZnRlciBhcHBseWluZyB0aGUgaXRlcmF0ZWUgZnVuY3Rpb24gdG8gdGhlaXIgZWxlbWVudHMuXG4gKlxuICogVGhpcyBmdW5jdGlvbiB0YWtlcyBtdWx0aXBsZSBhcnJheXMgYW5kIGFuIGl0ZXJhdGVlIGZ1bmN0aW9uIChvciBwcm9wZXJ0eSBrZXkpIHRvXG4gKiBjb21wYXJlIHRoZSBlbGVtZW50cyBhZnRlciB0cmFuc2Zvcm1pbmcgdGhlbS4gSXQgcmV0dXJucyBhIG5ldyBhcnJheSBjb250YWluaW5nIHRoZSBlbGVtZW50cyBmcm9tXG4gKiB0aGUgZmlyc3QgYXJyYXkgdGhhdCBhcmUgcHJlc2VudCBpbiBhbGwgc3Vic2VxdWVudCBhcnJheXMgYWZ0ZXIgYXBwbHlpbmcgdGhlIGl0ZXJhdGVlIHRvIGVhY2ggZWxlbWVudC5cbiAqXG4gKiBAdGVtcGxhdGUgVFxuICogQHBhcmFtIHtBcnJheUxpa2U8VD4gfCBudWxsIHwgdW5kZWZpbmVkfSBbYXJyYXldIC0gVGhlIGZpcnN0IGFycmF5IHRvIGNvbXBhcmUuXG4gKiBAcGFyYW0gey4uLkFycmF5TGlrZTxUPn0gdmFsdWVzIC0gQWRkaXRpb25hbCBhcnJheXMgdG8gY29tcGFyZS5cbiAqIEByZXR1cm5zIHtUW119IEEgbmV3IGFycmF5IGNvbnRhaW5pbmcgdGhlIGVsZW1lbnRzIGZyb20gdGhlIGZpcnN0IGFycmF5IHRoYXQgYXJlIHByZXNlbnRcbiAqICBpbiBhbGwgc3Vic2VxdWVudCBhcnJheXMgYWZ0ZXIgYXBwbHlpbmcgdGhlIGl0ZXJhdGVlLlxuICpcbiAqIEBleGFtcGxlXG4gKiBjb25zdCBhcnJheTEgPSBbMSwgMiwgM107XG4gKiBjb25zdCBhcnJheTIgPSBbMiwgM107XG4gKiBjb25zdCBhcnJheTMgPSBbM107XG4gKiBjb25zdCByZXN1bHQgPSBpbnRlcnNlY3Rpb25CeShhcnJheTEsIGFycmF5MiwgYXJyYXkzKTtcbiAqIC8vIHJlc3VsdCB3aWxsIGJlIFszXSBzaW5jZSB0aGVzZSBhbGwgZWxlbWVudHMgaGF2ZSB0aGUgc2FtZSB2YWx1ZSAzLlxuICovXG5leHBvcnQgZnVuY3Rpb24gaW50ZXJzZWN0aW9uQnk8VD4oYXJyYXk/OiBBcnJheUxpa2U8VD4gfCBudWxsIHwgdW5kZWZpbmVkLCAuLi52YWx1ZXM6IEFycmF5PEFycmF5TGlrZTxUPj4pOiBUW107XG5cbi8qKlxuICogUmV0dXJucyB0aGUgaW50ZXJzZWN0aW9uIG9mIG11bHRpcGxlIGFycmF5cyBhZnRlciBhcHBseWluZyB0aGUgaXRlcmF0ZWUgZnVuY3Rpb24gdG8gdGhlaXIgZWxlbWVudHMuXG4gKlxuICogVGhpcyBmdW5jdGlvbiB0YWtlcyBtdWx0aXBsZSBhcnJheXMgYW5kIGFuIG9wdGlvbmFsIGl0ZXJhdGVlIGZ1bmN0aW9uIChvciBwcm9wZXJ0eSBrZXkpXG4gKiB0byBjb21wYXJlIHRoZSBlbGVtZW50cyBhZnRlciB0cmFuc2Zvcm1pbmcgdGhlbS4gSXQgcmV0dXJucyBhIG5ldyBhcnJheSBjb250YWluaW5nIHRoZSBlbGVtZW50cyBmcm9tXG4gKiB0aGUgZmlyc3QgYXJyYXkgdGhhdCBhcmUgcHJlc2VudCBpbiBhbGwgc3Vic2VxdWVudCBhcnJheXMgYWZ0ZXIgYXBwbHlpbmcgdGhlIGl0ZXJhdGVlIHRvIGVhY2ggZWxlbWVudC5cbiAqIElmIG5vIGl0ZXJhdGVlIGlzIHByb3ZpZGVkLCB0aGUgaWRlbnRpdHkgZnVuY3Rpb24gaXMgdXNlZC5cbiAqXG4gKiBJZiB0aGUgZmlyc3QgYXJyYXkgaXMgYG51bGxgIG9yIGB1bmRlZmluZWRgLCBhbiBlbXB0eSBhcnJheSBpcyByZXR1cm5lZC5cbiAqXG4gKiBAdGVtcGxhdGUgVFxuICogQHBhcmFtIHtBcnJheUxpa2U8VD4gfCBudWxsIHwgdW5kZWZpbmVkfSBhcnJheSAtIFRoZSBmaXJzdCBhcnJheSB0byBjb21wYXJlLlxuICogQHBhcmFtIHsuLi4oQXJyYXlMaWtlPFQ+IHwgKCh2YWx1ZTogVCkgPT4gdW5rbm93bikgfCBzdHJpbmcpfSB2YWx1ZXMgLSBUaGUgYXJyYXlzIHRvIGNvbXBhcmUsIG9yIHRoZSBpdGVyYXRlZSBmdW5jdGlvbi5cbiAqIEByZXR1cm5zIHtUW119IEEgbmV3IGFycmF5IGNvbnRhaW5pbmcgdGhlIGVsZW1lbnRzIGZyb20gdGhlIGZpcnN0IGFycmF5IHRoYXQgYXJlIHByZXNlbnRcbiAqICBpbiBhbGwgc3Vic2VxdWVudCBhcnJheXMgYWZ0ZXIgYXBwbHlpbmcgdGhlIGl0ZXJhdGVlLlxuICpcbiAqIEBleGFtcGxlXG4gKiBjb25zdCBhcnJheTEgPSBbeyB4OiAxIH0sIHsgeDogMiB9LCB7IHg6IDMgfV07XG4gKiBjb25zdCBhcnJheTIgPSBbeyB4OiAyIH0sIHsgeDogMyB9XTtcbiAqIGNvbnN0IHJlc3VsdCA9IGludGVyc2VjdGlvbkJ5KGFycmF5MSwgYXJyYXkyLCAneCcpO1xuICogLy8gcmVzdWx0IHdpbGwgYmUgW3sgeDogMiB9LCB7IHg6IDMgfV0gc2luY2UgdGhlc2UgZWxlbWVudHMgaGF2ZSB0aGUgc2FtZSBgeGAgcHJvcGVydHkuXG4gKlxuICogQGV4YW1wbGVcbiAqIGNvbnN0IGFycmF5MSA9IFsxLjEsIDIuMiwgMy4zXTtcbiAqIGNvbnN0IGFycmF5MiA9IFsyLjMsIDMuM107XG4gKiBjb25zdCByZXN1bHQgPSBpbnRlcnNlY3Rpb25CeShhcnJheTEsIGFycmF5MiwgTWF0aC5mbG9vcik7XG4gKiAvLyByZXN1bHQgd2lsbCBiZSBbMi4zLCAzLjNdIHNpbmNlIGl0IHNoYXJlcyB0aGUgc2FtZSBpbnRlZ2VyIHBhcnQgd2hlbiBgTWF0aC5mbG9vcmAgaXMgYXBwbGllZC5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGludGVyc2VjdGlvbkJ5PFQ+KFxuICBhcnJheTogQXJyYXlMaWtlPFQ+IHwgbnVsbCB8IHVuZGVmaW5lZCxcbiAgLi4udmFsdWVzOiBBcnJheTxBcnJheUxpa2U8VD4gfCAoKHZhbHVlOiBUKSA9PiB1bmtub3duKSB8IHN0cmluZz5cbik6IFRbXSB7XG4gIGlmICghaXNBcnJheUxpa2VPYmplY3QoYXJyYXkpKSB7XG4gICAgcmV0dXJuIFtdO1xuICB9XG5cbiAgY29uc3QgbGFzdFZhbHVlID0gbGFzdCh2YWx1ZXMpO1xuICBpZiAobGFzdFZhbHVlID09PSB1bmRlZmluZWQpIHtcbiAgICByZXR1cm4gQXJyYXkuZnJvbShhcnJheSk7XG4gIH1cblxuICBsZXQgcmVzdWx0ID0gdW5pcShBcnJheS5mcm9tKGFycmF5KSk7XG5cbiAgY29uc3QgY291bnQgPSBpc0FycmF5TGlrZU9iamVjdChsYXN0VmFsdWUpID8gdmFsdWVzLmxlbmd0aCA6IHZhbHVlcy5sZW5ndGggLSAxO1xuXG4gIGZvciAobGV0IGkgPSAwOyBpIDwgY291bnQ7ICsraSkge1xuICAgIGNvbnN0IHZhbHVlID0gdmFsdWVzW2ldO1xuXG4gICAgaWYgKCFpc0FycmF5TGlrZU9iamVjdCh2YWx1ZSkpIHtcbiAgICAgIHJldHVybiBbXTtcbiAgICB9XG5cbiAgICBpZiAoaXNBcnJheUxpa2VPYmplY3QobGFzdFZhbHVlKSkge1xuICAgICAgcmVzdWx0ID0gaW50ZXJzZWN0aW9uQnlUb29sa2l0KHJlc3VsdCwgQXJyYXkuZnJvbSh2YWx1ZSksIGlkZW50aXR5KTtcbiAgICB9IGVsc2UgaWYgKHR5cGVvZiBsYXN0VmFsdWUgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgIHJlc3VsdCA9IGludGVyc2VjdGlvbkJ5VG9vbGtpdChyZXN1bHQsIEFycmF5LmZyb20odmFsdWUpLCB2YWx1ZSA9PiBsYXN0VmFsdWUodmFsdWUpKTtcbiAgICB9IGVsc2UgaWYgKHR5cGVvZiBsYXN0VmFsdWUgPT09ICdzdHJpbmcnKSB7XG4gICAgICByZXN1bHQgPSBpbnRlcnNlY3Rpb25CeVRvb2xraXQocmVzdWx0LCBBcnJheS5mcm9tKHZhbHVlKSwgcHJvcGVydHkobGFzdFZhbHVlKSk7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHJlc3VsdDtcbn1cbiJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxTQUFTLGtCQUFrQixxQkFBcUIsUUFBUSxnQ0FBZ0M7QUFDeEYsU0FBUyxJQUFJLFFBQVEsc0JBQXNCO0FBQzNDLFNBQVMsSUFBSSxRQUFRLHNCQUFzQjtBQUMzQyxTQUFTLFFBQVEsUUFBUSw2QkFBNkI7QUFDdEQsU0FBUyxRQUFRLFFBQVEsd0JBQXdCO0FBQ2pELFNBQVMsaUJBQWlCLFFBQVEsb0NBQW9DO0FBaUl0RTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0NBMkJDLEdBQ0QsT0FBTyxTQUFTLGVBQ2QsS0FBc0MsRUFDdEMsR0FBRyxNQUE4RDtFQUVqRSxJQUFJLENBQUMsa0JBQWtCLFFBQVE7SUFDN0IsT0FBTyxFQUFFO0VBQ1g7RUFFQSxNQUFNLFlBQVksS0FBSztFQUN2QixJQUFJLGNBQWMsV0FBVztJQUMzQixPQUFPLE1BQU0sSUFBSSxDQUFDO0VBQ3BCO0VBRUEsSUFBSSxTQUFTLEtBQUssTUFBTSxJQUFJLENBQUM7RUFFN0IsTUFBTSxRQUFRLGtCQUFrQixhQUFhLE9BQU8sTUFBTSxHQUFHLE9BQU8sTUFBTSxHQUFHO0VBRTdFLElBQUssSUFBSSxJQUFJLEdBQUcsSUFBSSxPQUFPLEVBQUUsRUFBRztJQUM5QixNQUFNLFFBQVEsTUFBTSxDQUFDLEVBQUU7SUFFdkIsSUFBSSxDQUFDLGtCQUFrQixRQUFRO01BQzdCLE9BQU8sRUFBRTtJQUNYO0lBRUEsSUFBSSxrQkFBa0IsWUFBWTtNQUNoQyxTQUFTLHNCQUFzQixRQUFRLE1BQU0sSUFBSSxDQUFDLFFBQVE7SUFDNUQsT0FBTyxJQUFJLE9BQU8sY0FBYyxZQUFZO01BQzFDLFNBQVMsc0JBQXNCLFFBQVEsTUFBTSxJQUFJLENBQUMsUUFBUSxDQUFBLFFBQVMsVUFBVTtJQUMvRSxPQUFPLElBQUksT0FBTyxjQUFjLFVBQVU7TUFDeEMsU0FBUyxzQkFBc0IsUUFBUSxNQUFNLElBQUksQ0FBQyxRQUFRLFNBQVM7SUFDckU7RUFDRjtFQUVBLE9BQU87QUFDVCJ9
// denoCacheMetadata=5714410601477521256,10388832442025513670